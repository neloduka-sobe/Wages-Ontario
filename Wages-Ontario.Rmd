---
title: "Analysis of Ontario wages in relation to economic factors based on Ontario Data Catalogue (1997-2019)"
author:
  - "Borys Łangowicz (1010725967)"
  - "Kian Dianati (1010205485)"
date: "2024-04-05"
output:
  html_document:
    number_sections: true
  pdf_document:
    number_sections: true
---

```{r, include=F}
library(tidyverse)
library(ggplot2)
library(knitr)
```

# Loading the Data

We will use the following data sets:

```{r}
wages = read.csv("wages.csv") %>% mutate_if(is.character, str_trim)

wages$Education.level =
  factor(wages$Education.level,
         levels = c("Above bachelor's degree",
                    "Bachelor's degree",
                    "University certificate below bachelors degree",
                    "University degree",
                    "Community college, CEGEP",
                    "Trade certificate or diploma",
                    "Post-secondary certificate or diploma",
                    "Some post-secondary",
                    "High school graduate",
                    "Some high school",
                    "PSE  (5,6,7,8,9))",
                    "No PSE  (0,1,2,3,4)",
                    "0 - 8  years",
                    "Total, all education levels"),
         ordered = TRUE)

wages$Age.group =
  factor(wages$Age.group,
         levels = c("25-64 years",
                    "25-54 years",
                    "25-34 years",
                    "20-34 years",
                    "15-24 years",
                    "55 years and over",
                    "25 years and over",
                    "15 years and over"),
         ordered = TRUE)
```

# Description of the Data set

The `wages` data set includes the average weekly wages rates by education level and immigration status for Canada and Ontario in the years from 1997 to 2019. It includes the following columns:

```{r}
names(wages)
```

1. `YEAR`: Indicates the year in which the data was collected.
2. `Geography`: Indicates the region from which the data was collected. Its 
   possible values include Canada as well as the Canadian provinces and 
   territories.
3. `Type.of.work`: Indicates whether the data in the row is for full-time 
   employees or part-time employees or both.
4. `Wages`:
    1. `Total employees`: The number of employees in the given age range, 
       education level, and job status.
    2. `Averag hourly wage rate`: The average hourly wage of the employees in 
       the given age range, education level, and job status.
    3. And so on for `Average weekly wage rate`, `Median hourly wage rate`, 
       and `Median weekly wage rate`.
5. `Education.level`: Indicates the level of education. It can include the 
   following:
```{r, echo=FALSE}
kable(wages %>%
  group_by(Education.level) %>%
  reframe(Education.level) %>%
  unique())
```
6. `Age.group`: Indicates the age range of the individuals under consideration.
   It can include the following:
```{r, echo=FALSE}
kable(wages %>%
  group_by(Age.group) %>%
  reframe(Age.group) %>%
  unique())
```
7. `Both.sexes`: The data not seperated by gender.
8. `Male`: The data for males.
9. `Female`: The data for females.

# The Background of the Data

# Research Questions

## Trend Analysis

  * How has the average hourly wage rate changed over the years across different regions?
  * Are there any noticeable trends in the median weekly wage rate for full-time employees over the past decade?
  * What is the overall trend in the number of full-time employees versus part-time employees across different age groups?
  
## Regional Disparities

  * How do average hourly wage rates vary between different Canadian provinces and territories?
  * Are there significant differences in the employment rates between urban and rural areas within a specific province?
  * Is there a noticeable gender wage gap within specific regions or provinces?
  
## Educational Attainment

  * How does the average hourly wage rate differ across various education levels?
  * Are there any trends in the employment rates based on different levels of education attainment?
  * Is there a correlation between educational attainment and the likelihood of being employed full-time versus part-time?
  
## Age Groups Analysis

  * How do wage rates vary across different age groups, and is there a trend in wage growth as individuals age?
  * Are there noticeable differences in employment rates between younger and older age groups?
  * What is the distribution of educational attainment among different age groups, and how does it correlate with employment status and wage rates?
  
## Gender Analysis

  * Is there a significant gender wage gap, and how has it evolved over time?
  * Are there differences in the distribution of employment types (full-time vs. part-time) between males and females?
  * How does educational attainment affect the gender wage gap within specific age groups or regions?
  
## Overall Employment Trends

  * How has the total number of employees changed over the years?
  * Are there seasonal variations in employment rates or wage rates within certain regions or industries?
  * What industries or sectors have shown the highest growth in employment rates, and how does this correlate with wage rates?
  
# Tables Summary

## How does the average hourly wage rate differ across various education levels for different genders?
```{R}
avg_wage_by_education <- wages %>%
  filter(Wages == "Average hourly wage rate") %>%
  select(Education.level, Male, Female) %>%
  group_by(Education.level) %>%
  summarise(male_avg = mean(Male),
            female_avg = mean(Female))

kable(avg_wage_by_education)
```

```{R}
ggplot(avg_wage_by_education, aes(x = Education.level)) +
  geom_bar(aes(y = male_avg), 
           stat = "identity", 
           fill = "blue", 
           alpha = 0.5,
           width = 0.55,
           position = "dodge") +
  geom_bar(aes(y = female_avg), 
           stat = "identity", 
           fill = "red", 
           alpha = 0.5, 
           width = 0.5,
           position = "dodge") +
  labs(title = "Average Hourly Wage Rate by Education Level and Gender",
       x = "Education Level",
       y = "Average Hourly Wage Rate",
       fill = "Gender") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  coord_flip()
```

# Graphs Summary

# Hypothesis Testing

# Bootstrapping

# Non-linear Regression Analysis

# Cross Validation

# Random Forest

# Random Forest Validation

# Summary of Research

# Appendix
