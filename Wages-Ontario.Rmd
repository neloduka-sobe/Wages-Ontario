---
title: "Analysis of Ontario wages in relation to economic factors based on Ontario Data Catalogue (1997-2019)"
author:
  - "Borys Łangowicz (1010725967)"
  - "Kian Dianati (1010205485)"
date: "2024-04-05"
output:
  pdf_document:
    number_sections: true
  html_document:
    number_sections: true
---

```{r, include=F}
library(tidyverse)
library(ggplot2)
library(reshape2)
library(knitr)
```

# Loading the Data

We will use the following data sets:

```{r}
wages = read.csv("wages.csv") %>% mutate_if(is.character, str_trim)

wages$Education.level =
  factor(wages$Education.level,
         levels = c("Above bachelor's degree",
                    "Bachelor's degree",
                    "University certificate below bachelors degree",
                    "University degree",
                    "Community college, CEGEP",
                    "Trade certificate or diploma",
                    "Post-secondary certificate or diploma",
                    "Some post-secondary",
                    "High school graduate",
                    "Some high school",
                    "PSE  (5,6,7,8,9))",
                    "No PSE  (0,1,2,3,4)",
                    "0 - 8  years",
                    "Total, all education levels"),
         ordered = TRUE)

wages$Age.group =
  factor(wages$Age.group,
         levels = c("25-64 years",
                    "25-54 years",
                    "25-34 years",
                    "20-34 years",
                    "15-24 years",
                    "55 years and over",
                    "25 years and over",
                    "15 years and over"),
         ordered = TRUE)

# Fuel
fuel = read.csv("fuel.csv") %>% mutate_if(is.character, str_trim)

```

# Description of the Data set

## Wages by education level 
The `wages` data set includes the average weekly wages rates by education level and immigration status for Canada and Ontario in the years from 1997 to 2019. It includes the following columns:

```{r}
names(wages)
```

1. `YEAR`: Indicates the year in which the data was collected.
2. `Geography`: Indicates the region from which the data was collected. Its 
   possible values include Canada as well as the Canadian provinces and 
   territories.
3. `Type.of.work`: Indicates whether the data in the row is for full-time 
   employees or part-time employees or both.
4. `Wages`:
    1. `Total employees`: The number of employees in the given age range, 
       education level, and job status.
    2. `Averag hourly wage rate`: The average hourly wage of the employees in 
       the given age range, education level, and job status.
    3. And so on for `Average weekly wage rate`, `Median hourly wage rate`, 
       and `Median weekly wage rate`.
5. `Education.level`: Indicates the level of education. It can include the 
   following:
```{r, echo=FALSE}
kable(wages %>%
  group_by(Education.level) %>%
  reframe(Education.level) %>%
  unique())
```
6. `Age.group`: Indicates the age range of the individuals under consideration.
   It can include the following:
```{r, echo=FALSE}
kable(wages %>%
  group_by(Age.group) %>%
  reframe(Age.group) %>%
  unique())
```
7. `Both.sexes`: The data not seperated by gender.
8. `Male`: The data for males.
9. `Female`: The data for females.

## Fuels price survey information 
```{r}
names(fuel)
```

# The Background of the Data

The labor and demographic dataset from the Ministry of Labour, Immigration, Training, and Skills Development provides insights into Ontario's workforce demographics, including age groups, employment types, educational levels, wages, and immigration statuses. It is annually updated and used by policymakers, researchers, and economists to inform decisions regarding education, training, workforce development, and immigration policies in the province.

Additionally, fuel price survey information from the Ministry of Energy offers weekly retail prices for gasoline, diesel, auto propane, and compressed natural gas across ten Ontario markets. This data aids in monitoring fuel price fluctuations and analyzing trends in the energy sector, supporting research and analysis efforts in economics, environmental studies, and energy policy.

# Overall Research Question

## Trend Analysis

  * How has the average hourly wage rate changed over the years across different age groups?
  * Are there any noticeable trends in the median weekly wage rate for full-time employees over the past decade?
  * What is the overall trend in the number of full-time employees versus part-time employees across different age groups?
  
## Regional Disparities

  * How do average hourly wage rates vary between different Canadian provinces and territories?
  * Are there significant differences in the employment rates between urban and rural areas within a specific province?
  
## Educational Attainment

  * How does the average hourly wage rate differ across various education levels?
  * Are there any trends in the employment rates based on different levels of education attainment?
  * Is there a correlation between educational attainment and the likelihood of being employed full-time versus part-time?
  
## Age Groups Analysis

  * How do wage rates vary across different age groups, and is there a trend in wage growth as individuals age?
  * Are there noticeable differences in employment rates between younger and older age groups?
  * What is the distribution of educational attainment among different age groups, and how does it correlate with employment status and wage rates?
  
## Gender Analysis

  * Is there a significant gender wage gap, and how has it evolved over time?
  * Are there differences in the distribution of employment types (full-time vs. part-time) between males and females?
  * How does educational attainment affect the gender wage gap within specific age groups or regions?
  
## Overall Employment Trends

  * How has the total number of employees changed over the years?
  * Are there seasonal variations in employment rates or wage rates within certain industries?
  * What industries or sectors have shown the highest growth in employment rates, and how does this correlate with wage rates?
  
# Summary

## How has the average hourly wage rate changed over the years across different age groups?
```{R}
avg_wage_by_age <- wages %>%
  filter(Wages == "Average hourly wage rate",
         Geography == "Canada",
         Type.of.work == "Full-time",
         Education.level == "Total, all education levels") %>%
  select(YEAR, Age.group, Both.Sexes) %>%
  group_by(YEAR, Age.group) %>%
  summarise(Avg_Hourly_Wage = mean(Both.Sexes))

kable(avg_wage_by_age %>%
  pivot_wider(names_from = Age.group, values_from = Avg_Hourly_Wage))
```


```{r}
ggplot(avg_wage_by_age %>% filter(YEAR == "2019"),
       aes(x = Age.group, Avg_Hourly_Wage)) +
  geom_bar(stat = "identity") +
  labs(x = "Age group",
       y = "Average Hourly Wage",
       title = "Wage by Age Group in 2019") +
  theme(text = element_text(size = 8))
```

**From the data, we can observe the following trends:**

1. Across all age groups, there is a general trend of increasing average hourly wage rates over the years.
2. The wage rates tend to increase with age, with the highest rates typically observed in the 55 years and over age group.
3. The 15-24 years age group consistently has the lowest average hourly wage rates, which gradually increase as individuals move into older age groups.
4. There is a noticeable increase in wage rates during the late 1990s and early 2000s, followed by a slight dip during the economic downturn of 2008-2009, after which wages steadily increased again.

These observations provide an overview of how the average hourly wage rates have changed over the years across different age groups.

## How does the average hourly wage rate differ across various education levels for different genders?
```{R}
avg_wage_by_education <- wages %>%
  filter(Wages == "Average hourly wage rate", 
         Geography == "Canada",
         Age.group == "15 years and over",
         Type.of.work == "Both full- and part-time") %>%
  select(Education.level, Male, Female) %>%
  group_by(Education.level) %>%
  summarise(male_avg = mean(Male),
            female_avg = mean(Female))

kable(avg_wage_by_education)
```

```{R}
ggplot(avg_wage_by_education %>% melt(),
       aes(x = Education.level, fill = variable)) +
  geom_bar(aes(y = value), 
           stat = "identity", 
           alpha = 0.8,
           show.legend = TRUE,
           position = position_identity()) +
  labs(title = "Average Hourly Wage Rate by Education Level and Gender",
       x = "Education Level",
       y = "Average Hourly Wage Rate",
       fill = "Gender") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        text = element_text(size = 8),
        legend.position = "bottom") +
  coord_flip()
```

**Observations:**

1. In almost all cases, the average hourly wage for males is higher than for females across various education levels.
2. The wage gap tends to decrease as the education level increases.
3. The largest wage gaps are observed at lower education levels, such as "Some high school" and "0 - 8 years", where the male average wage is significantly higher than the female average wage.
4. At higher education levels, such as "Above bachelor’s degree" and "Bachelor’s degree", the wage gap is relatively smaller compared to lower education levels but still exists.

These observations highlight disparities in wages between genders across different education levels, indicating the presence of gender-based wage inequality.

## What is the overall trend in the number of full-time employees versus part-time employees across different age groups?

```{R}
unique(wages$Type.of.work)

full_time_part_time <- wages %>% group_by(Age.group, Type.of.work) %>% summarise(Employees = sum(Both.Sexes))

options(scipen = 999)
ggplot(full_time_part_time, aes(x = Age.group, y = Employees, fill = Type.of.work)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Number of Full-time, Part-time vs Part- and Full-time Employees\n Across Age Groups",
       x = "Age Group",
       y = "Number of Employees",
       fill = "Type of Work") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


# Hypothesis Testing

# Bootstrapping

# Non-linear Regression Analysis

# Cross Validation

# Random Forest

# Random Forest Validation

# Summary of Research

# Appendix
